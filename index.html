<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ - ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        purple: {
                            50: '#faf5ff',
                            100: '#f3e8ff',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            700: '#6d28d9',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(-100%); } to { transform: translateX(0); } }
        .popup-overlay { backdrop-filter: blur(5px); }
        .breadcrumb { display: flex; align-items: center; gap: 8px; margin-bottom: 24px; }
        .breadcrumb a { color: #7c3aed; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #6b7280; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-purple-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <!-- Logo -->
                    <div class="relative cursor-pointer" onclick="goToHome()">
                        <img src="https://lh3.googleusercontent.com/d/1z3uZjYrJyUJW20pFuxB18rclWWZVtEAP" alt="ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ" 
                             class="w-16 h-16 rounded-full object-cover drop-shadow-lg border-2 border-purple-200"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMzIiIGN5PSIzMiIgcj0iMzIiIGZpbGw9IiM4YjVjZjYiLz4KPHN2ZyB4PSIxNiIgeT0iMTYiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0tMiAxNWwtNS01IDEuNDEtMS40MUwxMCAxNC4xN2w3LjU5LTcuNTlMMTkgOGwtOSA5eiIvPgo8L3N2Zz4KPC9zdmc+'; this.alt='ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ';">
                    </div>
                    <div class="cursor-pointer" onclick="goToHome()">
                        <h1 class="text-xl font-bold text-gray-900">ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ</h1>
                        <p class="text-sm text-purple-600">ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ</p>
                    </div>
                </div>
                
                <!-- Search Bar -->
                <div class="hidden md:flex flex-1 max-w-md mx-8">
                    <div class="relative w-full">
                        <input type="text" placeholder="ุงูุจุญุซ ุนู ูุงุฏุฉ ุฃู ููู..." 
                               class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <span class="text-gray-400">๐</span>
                        </div>
                    </div>
                </div>

                <!-- User Menu (Hidden by default) -->
                <div id="userMenu" class="hidden flex items-center space-x-4 space-x-reverse">
                    <!-- Notifications -->
                    <div class="relative">
                        <button id="notificationBtn" class="p-2 text-gray-600 hover:text-purple-600 relative">
                            <span class="text-xl">๐</span>
                            <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                        </button>
                        
                        <!-- Notifications Popup -->
                        <div id="notificationsPopup" class="absolute left-0 mt-2 w-80 bg-white rounded-lg shadow-lg border hidden z-50">
                            <div class="p-4 border-b">
                                <div class="flex items-center justify-between">
                                    <h3 class="font-semibold text-gray-900">ุงูุฅุดุนุงุฑุงุช</h3>
                                    <button id="closeNotifications" class="text-gray-400 hover:text-gray-600">โ</button>
                                </div>
                            </div>
                            <div id="notificationsList" class="max-h-64 overflow-y-auto">
                                <!-- Notifications will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile -->
                    <div class="relative">
                        <button id="profileBtn" class="flex items-center space-x-2 space-x-reverse">
                            <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center overflow-hidden">
                                <img id="userAvatar" src="" alt="" class="w-full h-full object-cover hidden">
                                <span id="userInitial" class="text-white text-sm font-medium">A</span>
                            </div>
                            <div class="text-right">
                                <span id="userDisplayName" class="text-gray-700 font-medium block">ุฃุญูุฏ</span>
                                <span id="userStatus" class="text-xs text-gray-500">ูุชุงุญ</span>
                            </div>
                        </button>
                        
                        <!-- Profile Dropdown -->
                        <div id="profileDropdown" class="absolute left-0 mt-2 w-48 bg-white rounded-lg shadow-lg border hidden z-50">
                            <div class="p-4 border-b">
                                <p id="dropdownUsername" class="font-medium text-gray-900">ุฃุญูุฏ ูุญูุฏ</p>
                                <p id="dropdownYear" class="text-sm text-gray-500">ุงูุณูุฉ ุงูุซุงูุซุฉ</p>
                            </div>
                            <div class="py-2">
                                <button onclick="showProfile()" class="w-full text-right px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ุงูููู ุงูุดุฎุตู</button>
                                <button class="w-full text-right px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ุงูููุถูุฉ</button>
                                <button onclick="showSettings()" class="w-full text-right px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ุงูุฅุนุฏุงุฏุงุช</button>
                                <hr class="my-2">
                                <button id="logoutBtn" class="w-full text-right px-4 py-2 text-sm text-red-600 hover:bg-red-50">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Login Button -->
                <button id="loginBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                    ุชุณุฌูู ุงูุฏุฎูู
                </button>
            </div>
        </div>
    </header>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 popup-overlay hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4 fade-in">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-2xl">๐ฅ</span>
                </div>
                <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 mb-2">ุชุณุฌูู ุงูุฏุฎูู</h2>
                <p id="modalSubtitle" class="text-gray-600">ุฃุฏุฎู ุจูุงูุงุชู ูููุตูู ุฅูู ุงูููุตุฉ</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงุณู ุงููุณุชุฎุฏู</label>
                    <input type="text" id="username" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="password" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-medium transition-colors">
                    ุฏุฎูู
                </button>
            </form>
            
            <form id="registerForm" class="space-y-4 hidden">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงุณู ุงููุณุชุฎุฏู</label>
                    <input type="text" id="regUsername" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="regEmail" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุณุชูู ุงูุฏุฑุงุณู</label>
                    <select id="regYear" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="">ุงุฎุชุฑ ุงููุณุชูู ุงูุฏุฑุงุณู</option>
                        <option value="1">ุงูุณูุฉ ุงูุฃููู</option>
                        <option value="2">ุงูุณูุฉ ุงูุซุงููุฉ</option>
                        <option value="3">ุงูุณูุฉ ุงูุซุงูุซุฉ</option>
                        <option value="4">ุงูุณูุฉ ุงูุฑุงุจุนุฉ</option>
                        <option value="5">ุงูุณูุฉ ุงูุฎุงูุณุฉ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุชุงุฑูุฎ ุงููููุงุฏ</label>
                    <input type="date" id="regBirthdate" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="regPassword" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                </div>
                <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-medium transition-colors">
                    ุฅูุดุงุก ุญุณุงุจ
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button id="toggleForm" class="text-purple-600 hover:text-purple-700 text-sm">
                    ููุณ ูุฏูู ุญุณุงุจุ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
                </button>
            </div>
            
            <button id="closeLogin" class="absolute top-4 left-4 text-gray-400 hover:text-gray-600">
                <span class="text-xl">โ</span>
            </button>
        </div>
    </div>

    <!-- Welcome Popup -->
    <div id="welcomePopup" class="fixed inset-0 bg-black bg-opacity-50 popup-overlay hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-full mx-4 fade-in">
            <div class="text-center">
                <div class="mx-auto mb-6">
                    <img src="https://lh3.googleusercontent.com/d/1z3uZjYrJyUJW20pFuxB18rclWWZVtEAP" alt="ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ" 
                         class="w-20 h-20 rounded-full object-cover drop-shadow-lg border-2 border-purple-200 mx-auto"
                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM4YjVjZjYiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0tMiAxNWwtNS01IDEuNDEtMS40MUwxMCAxNC4xN2w3LjU5LTcuNTlMMTkgOGwtOSA5eiIvPgo8L3N2Zz4KPC9zdmc+'; this.alt='ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ';">
                </div>
                <h2 class="text-2xl font-bold text-gray-900 mb-4">ูุฑุญุจูุง ุจู ุนุฒูุฒู ุทุจูุจ ุงูุฅูุณุงููุฉ <span id="welcomeUsername" class="text-purple-600"></span></h2>
                <div class="text-right bg-purple-50 p-6 rounded-lg mb-6">
                    <p class="text-gray-700 leading-relaxed mb-4">
                        ูุฐุง ุงูุจูุช ููุตููู ูู ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ ุฎุตูุตูุง ูู ููููู ุฎูุฑู ููุนูู ูุฑูููู ูู ูู ุณููุงุชู ุงูุฏูุฑุงุณูุฉุ ููุดูู ูุงูุฉ ุงููุตุงุฏุฑ ุงููุงุฒูุฉ ููุฑุญูุฉ ุงูุจูุณู ููุณููุงุช ุงูุซูุงุซ ุงูุฃููู. ๐ฑ
                    </p>
                    <p class="text-purple-600 font-medium mb-4">ูุง ุชูุณููุง ุจุฏุนูุฉ ุตุงูุญุฉ ูู ุธูุฑ ุงูุบูุจ ๐</p>
                    <div class="text-sm text-gray-600">
                        <p class="font-medium">ุงููุฑูู ุงูุฃูุงุฏููู</p>
                        <p>ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ</p>
                    </div>
                </div>
                <button id="closeWelcome" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-medium transition-colors">
                    ุงุจุฏุฃ ุงูุชุตูุญ
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Navigation Controls -->
        <div class="flex items-center justify-between mb-6">
            <!-- Back Button -->
            <button id="backBtn" onclick="goBack()" class="hidden bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2">
                โ ุงูุนูุฏุฉ
            </button>
            
            <!-- Breadcrumb Navigation -->
            <div id="breadcrumb" class="breadcrumb hidden">
                <!-- Breadcrumb will be populated dynamically -->
            </div>
        </div>

        <!-- Announcements Section -->
        <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 mb-8 text-white">
            <h3 class="text-xl font-bold mb-2">๐ข ุงูุชุญุฏูุซุงุช ูุงูุฅุนูุงูุงุช ุงูุฃูุงุฏูููุฉ</h3>
            <p class="opacity-90">ูุฑุญุจุงู ุจูู ูู ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ ุงูุฌุฏูุฏุฉ! ุชู ุฅุถุงูุฉ ูุญุชูู ุฌุฏูุฏ ููุณูุฉ ุงูุซุงูุซุฉ.</p>
        </div>

        <div class="flex gap-8">
            <!-- Sidebar -->
            <div class="w-80 bg-white rounded-xl shadow-sm p-6 h-fit">
                <!-- Tabs for logged in users -->
                <div id="sidebarTabs" class="hidden mb-6">
                    <div class="flex bg-gray-100 rounded-lg p-1">
                        <button id="academicTab" class="flex-1 py-2 px-3 text-sm font-medium rounded-md bg-purple-600 text-white transition-colors">
                            ๐ ุงูููุงุฏ
                        </button>
                        <button id="postsTab" class="flex-1 py-2 px-3 text-sm font-medium rounded-md text-gray-600 hover:text-purple-600 transition-colors">
                            ๐ ุงูููุดูุฑุงุช
                        </button>
                        <button id="examsTab" class="flex-1 py-2 px-3 text-sm font-medium rounded-md text-gray-600 hover:text-purple-600 transition-colors">
                            ๐ ุงูุงูุชุญุงูุงุช
                        </button>
                        <button id="chatTab" class="flex-1 py-2 px-3 text-sm font-medium rounded-md text-gray-600 hover:text-purple-600 transition-colors">
                            ๐ฌ ุงูุฏุฑุฏุดุฉ
                        </button>
                    </div>
                </div>
                
                <!-- Academic Content -->
                <div id="academicContent">
                    <h3 class="text-lg font-bold text-gray-900 mb-6">ุงูุชูุณูู ุงูุฃูุงุฏููู</h3>
                </div>
                
                <!-- Posts Content -->
                <div id="postsContent" class="hidden">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold text-gray-900">ุงูููุดูุฑุงุช</h3>
                        <button onclick="showCreatePost()" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm">
                            โ ููุดูุฑ
                        </button>
                    </div>
                    <div id="postsList" class="space-y-4">
                        <!-- Posts will be populated here -->
                    </div>
                </div>
                
                <!-- Exams Content -->
                <div id="examsContent" class="hidden">
                    <h3 class="text-lg font-bold text-gray-900 mb-6">ุฌุฏูู ุงูุงูุชุญุงูุงุช</h3>
                    <div class="space-y-4">
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-900">ุงูุชุดุฑูุญ</h4>
                                <span class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded">VET101</span>
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p>๐ 2024-01-15</p>
                                <p>๐ 10:00 ุตุจุงุญุงู</p>
                                <p>๐ ุงูุชุญุงู ููุงุฆู</p>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold text-gray-900">ุนูู ูุธุงุฆู ุงูุฃุนุถุงุก</h4>
                                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">VET102</span>
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p>๐ 2024-01-20</p>
                                <p>๐ 2:00 ูุณุงุกู</p>
                                <p>๐ ุงูุชุญุงู ูุตูู</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Chat Content -->
                <div id="chatContent" class="hidden">
                    <h3 class="text-lg font-bold text-gray-900 mb-6">ุงูุฏุฑุฏุดุฉ ูุน ุงูุฅุฏุงุฑุฉ</h3>
                    <div class="bg-gray-50 rounded-lg p-4 h-64 overflow-y-auto mb-4" id="chatMessages">
                        <div class="bg-purple-100 p-3 rounded-lg mr-8 mb-3">
                            <p class="text-sm text-gray-700">ูุฑุญุจุงู! ููู ูููููุง ูุณุงุนุฏุชูุ</p>
                            <span class="text-xs text-gray-500">ุงูุฅุฏุงุฑุฉ - 10:30</span>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="chatInput" placeholder="ุงูุชุจ ุฑุณุงูุชู..."
                               class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm">
                        <button id="sendChatBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm">
                            ุฅุฑุณุงู
                        </button>
                    </div>
                </div>
                
                <h3 class="text-lg font-bold text-gray-900 mb-6">ุงูุชูุณูู ุงูุฃูุงุฏููู</h3>
                
                <div class="space-y-2">
                    <div class="year-section">
                        <button class="year-btn w-full text-right p-3 rounded-lg hover:bg-purple-50 transition-colors flex items-center justify-between" data-year="1">
                            <span class="font-medium text-gray-700">ุงูุณูุฉ ุงูุฃููู</span>
                            <span class="text-purple-600 transform transition-transform">โผ</span>
                        </button>
                        <div class="year-content hidden pl-4 mt-2 space-y-2">
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="1">
                                    <span>ุงููุตู ุงูุฃูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="2">
                                    <span>ุงููุตู ุงูุซุงูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Repeat for other years -->
                    <div class="year-section">
                        <button class="year-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-year="2">
                            <span class="font-medium text-gray-700">ุงูุณูุฉ ุงูุซุงููุฉ</span>
                            <span class="text-purple-600 transform transition-transform">โผ</span>
                        </button>
                        <div class="year-content hidden pl-4 mt-2 space-y-2">
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="1">
                                    <span>ุงููุตู ุงูุฃูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="2">
                                    <span>ุงููุตู ุงูุซุงูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="year-section">
                        <button class="year-btn w-full text-right p-3 rounded-lg hover:bg-purple-50 transition-colors flex items-center justify-between" data-year="3">
                            <span class="font-medium text-gray-700">ุงูุณูุฉ ุงูุซุงูุซุฉ</span>
                            <span class="text-purple-600 transform transition-transform">โผ</span>
                        </button>
                        <div class="year-content hidden pl-4 mt-2 space-y-2">
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="1">
                                    <span>ุงููุตู ุงูุฃูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="2">
                                    <span>ุงููุตู ุงูุซุงูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="year-section">
                        <button class="year-btn w-full text-right p-3 rounded-lg hover:bg-purple-50 transition-colors flex items-center justify-between" data-year="4">
                            <span class="font-medium text-gray-700">ุงูุณูุฉ ุงูุฑุงุจุนุฉ</span>
                            <span class="text-purple-600 transform transition-transform">โผ</span>
                        </button>
                        <div class="year-content hidden pl-4 mt-2 space-y-2">
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="1">
                                    <span>ุงููุตู ุงูุฃูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ููุฎุตุงุช</button>
                                </div>
                            </div>
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="2">
                                    <span>ุงููุตู ุงูุซุงูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="year-section">
                        <button class="year-btn w-full text-right p-3 rounded-lg hover:bg-purple-50 transition-colors flex items-center justify-between" data-year="5">
                            <span class="font-medium text-gray-700">ุงูุณูุฉ ุงูุฎุงูุณุฉ</span>
                            <span class="text-purple-600 transform transition-transform">โผ</span>
                        </button>
                        <div class="year-content hidden pl-4 mt-2 space-y-2">
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="1">
                                    <span>ุงููุตู ุงูุฃูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                            <div class="semester-section">
                                <button class="semester-btn w-full text-right p-2 text-sm text-gray-600 hover:text-purple-600 flex items-center justify-between" data-semester="2">
                                    <span>ุงููุตู ุงูุซุงูู</span>
                                    <span class="transform transition-transform">โผ</span>
                                </button>
                                <div class="semester-content hidden pl-4 mt-2 space-y-1">
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="slides">๐ ุณูุงูุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="recordings">๐๏ธ ุฑูููุฑุฏุงุช</button>
                                    <button class="content-btn w-full text-right p-2 text-sm text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded" data-type="summaries">๐ ููุฎุตุงุช</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="flex-1">
                <div id="contentArea" class="bg-white rounded-xl shadow-sm p-8">
                    <div class="text-center py-16">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">ูุฑุญุจุงู ุจู ูู ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ</h2>
                        <p class="text-gray-600 mb-8">ุงุฎุชุฑ ุงูุณูุฉ ูุงููุตู ุงูุฏุฑุงุณู ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูููุตูู ุฅูู ุงููุญุชูู ุงูุฃูุงุฏููู</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-2xl mx-auto">
                            <div class="bg-purple-50 p-6 rounded-lg">
                                <div class="text-3xl mb-3">๐</div>
                                <h3 class="font-semibold text-gray-900 mb-2">ุณูุงูุฏุงุช</h3>
                                <p class="text-sm text-gray-600">ุนุฑูุถ ุชูุฏูููุฉ ุดุงููุฉ ูุฌููุน ุงูููุงุฏ</p>
                            </div>
                            <div class="bg-purple-50 p-6 rounded-lg">
                                <div class="text-3xl mb-3">๐๏ธ</div>
                                <h3 class="font-semibold text-gray-900 mb-2">ุฑูููุฑุฏุงุช</h3>
                                <p class="text-sm text-gray-600">ุชุณุฌููุงุช ุตูุชูุฉ ูููุญุงุถุฑุงุช</p>
                            </div>
                            <div class="bg-purple-50 p-6 rounded-lg">
                                <div class="text-3xl mb-3">๐</div>
                                <h3 class="font-semibold text-gray-900 mb-2">ููุฎุตุงุช</h3>
                                <p class="text-sm text-gray-600">ููุฎุตุงุช ูุฑูุฒุฉ ูุดุงููุฉ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center">
                <div class="flex justify-center mb-4">
                    <img src="https://lh3.googleusercontent.com/d/1z3uZjYrJyUJW20pFuxB18rclWWZVtEAP" alt="ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ" 
                         class="w-20 h-20 rounded-full object-cover drop-shadow-lg border-2 border-purple-200"
                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM4YjVjZjYiLz4KPHN2ZyB4PSIyMCIgeT0iMjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0tMiAxNWwtNS01IDEuNDEtMS40MUwxMCAxNC4xN2w3LjU5LTcuNTlMMTkgOGwtOSA5eiIvPgo8L3N2Zz4KPC9zdmc+'; this.alt='ุดุนุงุฑ ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ';">
                </div>
                <p class="text-gray-600">ููุตุฉ ุฃูุงุฏูููุฉ ููุฏูุฉ ูู ูุฌูุฉ ุงูุทุจ ูุงูุฌุฑุงุญุฉ ุงูุจูุทุฑูุฉ โ ูููุฉ ุงูุทุจ ุงูุจูุทุฑู</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let currentUser = null;
        let userBookmarks = [];
        let userProgress = {};
        let navigationHistory = [];
        let currentPage = 'home';
        let notifications = [];
        let posts = [];
        let users = [];
        let loginHistory = [];
        let userStats = {
            today: 0,
            thisWeek: 0,
            thisMonth: 0,
            total: 0
        };

        // Initialize system
        function initializeSystem() {
            // Load data from localStorage
            loadUserData();
            loadSystemData();
            
            // Check for automatic year updates
            checkYearUpdate();
            
            // Update user statistics
            updateUserStats();
            
            // Initialize posts
            initializePosts();
            
            // Initialize demo data
            initializeDemoData();
        }

        function initializeDemoData() {
            // Add some demo users if none exist
            if (users.length === 0) {
                const demoUsers = [
                    { id: 1, username: 'ุฃุญูุฏ ูุญูุฏ', email: 'ahmed@example.com', year: 3, registrationDate: new Date(Date.now() - 86400000 * 30).toISOString(), lastLogin: new Date().toISOString(), status: 'ูุชุงุญ' },
                    { id: 2, username: 'ูุงุทูุฉ ุนูู', email: 'fatima@example.com', year: 2, registrationDate: new Date(Date.now() - 86400000 * 20).toISOString(), lastLogin: new Date(Date.now() - 3600000).toISOString(), status: 'ูุดุบูู' },
                    { id: 3, username: 'ูุญูุฏ ุญุณู', email: 'mohamed@example.com', year: 1, registrationDate: new Date(Date.now() - 86400000 * 10).toISOString(), lastLogin: new Date(Date.now() - 86400000).toISOString(), status: 'ูุชุงุญ' },
                    { id: 4, username: 'ุณุงุฑุฉ ุฃุญูุฏ', email: 'sara@example.com', year: 4, registrationDate: new Date(Date.now() - 86400000 * 5).toISOString(), lastLogin: new Date(Date.now() - 7200000).toISOString(), status: 'ูู ุงูุชุญุงู' },
                    { id: 5, username: 'ุนุจุฏุงููู ูุญูุฏ', email: 'abdullah@example.com', year: 5, registrationDate: new Date(Date.now() - 86400000 * 2).toISOString(), lastLogin: new Date(Date.now() - 1800000).toISOString(), status: 'ูุชุงุญ' }
                ];
                users = demoUsers;
                saveUserData();
            }
        }

        function loadUserData() {
            const savedUsers = localStorage.getItem('systemUsers');
            if (savedUsers) {
                users = JSON.parse(savedUsers);
            }
            
            const savedStats = localStorage.getItem('userStats');
            if (savedStats) {
                userStats = JSON.parse(savedStats);
            }
            
            const savedLoginHistory = localStorage.getItem('loginHistory');
            if (savedLoginHistory) {
                loginHistory = JSON.parse(savedLoginHistory);
            }
        }

        function loadSystemData() {
            const savedNotifications = localStorage.getItem('systemNotifications');
            if (savedNotifications) {
                notifications = JSON.parse(savedNotifications);
            }
            
            const savedPosts = localStorage.getItem('systemPosts');
            if (savedPosts) {
                posts = JSON.parse(savedPosts);
            }
        }

        function saveUserData() {
            localStorage.setItem('systemUsers', JSON.stringify(users));
            localStorage.setItem('userStats', JSON.stringify(userStats));
            localStorage.setItem('loginHistory', JSON.stringify(loginHistory));
        }

        function saveSystemData() {
            localStorage.setItem('systemNotifications', JSON.stringify(notifications));
            localStorage.setItem('systemPosts', JSON.stringify(posts));
        }

        function checkYearUpdate() {
            const today = new Date();
            const currentYear = today.getFullYear();
            const september1 = new Date(currentYear, 8, 1); // September 1st
            
            const lastUpdate = localStorage.getItem('lastYearUpdate');
            const lastUpdateDate = lastUpdate ? new Date(lastUpdate) : new Date(0);
            
            if (today >= september1 && lastUpdateDate < september1) {
                // Update all users' years
                users.forEach(user => {
                    if (user.year < 5) {
                        user.year++;
                    }
                });
                
                localStorage.setItem('lastYearUpdate', today.toISOString());
                saveUserData();
                
                // Add notification about year update
                addNotification('ุชู ุชุญุฏูุซ ุงููุณุชููุงุช ุงูุฏุฑุงุณูุฉ ุชููุงุฆูุงู ูุฌููุน ุงูุทูุงุจ', 'system', 'year-update');
            }
        }

        function updateUserStats() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const thisWeekStart = new Date(today);
            thisWeekStart.setDate(today.getDate() - today.getDay());
            const thisMonthStart = new Date(now.getFullYear(), now.getMonth(), 1);
            
            // Count users by time periods
            userStats.total = users.length;
            userStats.today = users.filter(user => {
                if (!user.lastLogin) return false;
                const loginDate = new Date(user.lastLogin);
                const loginDay = new Date(loginDate.getFullYear(), loginDate.getMonth(), loginDate.getDate());
                return loginDay.getTime() === today.getTime();
            }).length;
            
            userStats.thisWeek = users.filter(user => {
                if (!user.lastLogin) return false;
                const loginDate = new Date(user.lastLogin);
                return loginDate >= thisWeekStart;
            }).length;
            
            userStats.thisMonth = users.filter(user => {
                if (!user.lastLogin) return false;
                const loginDate = new Date(user.lastLogin);
                return loginDate >= thisMonthStart;
            }).length;
            
            saveUserData();
        }

        function initializePosts() {
            if (posts.length === 0) {
                posts = [
                    {
                        id: 1,
                        author: 'ุงูุฅุฏุงุฑุฉ',
                        authorRole: 'admin',
                        content: 'ูุฑุญุจุงู ุจุฌููุน ุงูุทูุงุจ ูู ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ ุงูุฌุฏูุฏุฉ! ูุชููู ููู ุชุฌุฑุจุฉ ูููุฏุฉ ูููุชุนุฉ.',
                        image: null,
                        timestamp: new Date().toISOString(),
                        likes: 15,
                        comments: [
                            { author: 'ุฃุญูุฏ ูุญูุฏ', content: 'ุดูุฑุงู ููู ุนูู ูุฐู ุงูููุตุฉ ุงูุฑุงุฆุนุฉ!', timestamp: new Date().toISOString() }
                        ],
                        targetYear: null // null means all years
                    }
                ];
                saveSystemData();
            }
        }

        // Navigation functions with history tracking
        function goToHome() {
            if (currentPage !== 'home') {
                navigationHistory.push({
                    page: currentPage,
                    title: getPageTitle(currentPage),
                    action: getPageAction(currentPage)
                });
            }
            
            currentPage = 'home';
            updateBreadcrumb([]);
            updateBackButton();
            
            document.getElementById('contentArea').innerHTML = `
                <div class="text-center py-16">
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">ูุฑุญุจุงู ุจู ูู ุงูููุตุฉ ุงูุฃูุงุฏูููุฉ</h2>
                    <p class="text-gray-600 mb-8">ุงุฎุชุฑ ุงูุณูุฉ ูุงููุตู ุงูุฏุฑุงุณู ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูููุตูู ุฅูู ุงููุญุชูู ุงูุฃูุงุฏููู</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-2xl mx-auto">
                        <div class="bg-purple-50 p-6 rounded-lg">
                            <div class="text-3xl mb-3">๐</div>
                            <h3 class="font-semibold text-gray-900 mb-2">ุณูุงูุฏุงุช</h3>
                            <p class="text-sm text-gray-600">ุนุฑูุถ ุชูุฏูููุฉ ุดุงููุฉ ูุฌููุน ุงูููุงุฏ</p>
                        </div>
                        <div class="bg-purple-50 p-6 rounded-lg">
                            <div class="text-3xl mb-3">๐๏ธ</div>
                            <h3 class="font-semibold text-gray-900 mb-2">ุฑูููุฑุฏุงุช</h3>
                            <p class="text-sm text-gray-600">ุชุณุฌููุงุช ุตูุชูุฉ ูููุญุงุถุฑุงุช</p>
                        </div>
                        <div class="bg-purple-50 p-6 rounded-lg">
                            <div class="text-3xl mb-3">๐</div>
                            <h3 class="font-semibold text-gray-900 mb-2">ููุฎุตุงุช</h3>
                            <p class="text-sm text-gray-600">ููุฎุตุงุช ูุฑูุฒุฉ ูุดุงููุฉ</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function goBack() {
            if (navigationHistory.length > 0) {
                const previousPage = navigationHistory.pop();
                currentPage = previousPage.page;
                
                // Execute the action to go back to the previous page
                if (previousPage.action) {
                    eval(previousPage.action);
                }
                
                updateBackButton();
            }
        }

        function updateBackButton() {
            const backBtn = document.getElementById('backBtn');
            if (navigationHistory.length > 0) {
                backBtn.classList.remove('hidden');
            } else {
                backBtn.classList.add('hidden');
            }
        }

        function getPageTitle(page) {
            const titles = {
                'home': 'ุงูุฑุฆูุณูุฉ',
                'profile': 'ุงูููู ุงูุดุฎุตู',
                'admin': 'ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ',
                'users': 'ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู',
                'settings': 'ุฅุนุฏุงุฏุงุช ุงููุธุงู',
                'posts': 'ุงูููุดูุฑุงุช',
                'create-post': 'ุฅูุดุงุก ููุดูุฑ',
                'login-history': 'ุณุฌู ุชุณุฌูู ุงูุฏุฎูู'
            };
            return titles[page] || page;
        }

        function getPageAction(page) {
            const actions = {
                'home': 'goToHome()',
                'profile': 'showProfile()',
                'admin': 'showAdminDashboard()',
                'users': 'showUserManagement()',
                'settings': 'showSettings()',
                'posts': 'switchTab("posts")',
                'create-post': 'showCreatePost()',
                'login-history': 'showLoginHistory()'
            };
            return actions[page] || '';
        }

        function updateBreadcrumb(items) {
            const breadcrumb = document.getElementById('breadcrumb');
            if (items.length === 0) {
                breadcrumb.classList.add('hidden');
                return;
            }
            
            breadcrumb.classList.remove('hidden');
            breadcrumb.innerHTML = items.map((item, index) => {
                if (index === items.length - 1) {
                    return `<span class="text-gray-600">${item.name}</span>`;
                } else {
                    return `<a href="#" onclick="${item.action}">${item.name}</a><span class="text-gray-400">โ</span>`;
                }
            }).join('');
        }

        // Enhanced notification system with interactive actions
        function addNotification(message, type = 'info', action = null, targetUser = null, actionData = null) {
            const notification = {
                id: Date.now(),
                message: message,
                type: type,
                action: action,
                actionData: actionData,
                timestamp: new Date().toISOString(),
                read: false,
                targetUser: targetUser
            };
            
            notifications.unshift(notification);
            saveSystemData();
            updateNotificationBadge();
        }

        function updateNotificationBadge() {
            const badge = document.getElementById('notificationBadge');
            const unreadCount = notifications.filter(n => !n.read && 
                (!n.targetUser || n.targetUser === currentUser?.username)).length;
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        function showNotifications() {
            const notificationsList = document.getElementById('notificationsList');
            const userNotifications = notifications.filter(n => 
                !n.targetUser || n.targetUser === currentUser?.username || currentUser?.role === 'admin'
            );
            
            if (userNotifications.length === 0) {
                notificationsList.innerHTML = '<p class="p-4 text-gray-500 text-center">ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช</p>';
                return;
            }
            
            notificationsList.innerHTML = userNotifications.map(notification => `
                <div class="p-4 border-b hover:bg-gray-50 ${notification.read ? '' : 'bg-blue-50'} cursor-pointer" 
                     onclick="handleNotificationClick('${notification.id}', '${notification.action}', ${JSON.stringify(notification.actionData).replace(/"/g, '&quot;')})">
                    <div class="flex items-start">
                        <span class="text-blue-500 ml-3">${getNotificationIcon(notification.type)}</span>
                        <div class="flex-1">
                            <p class="text-sm text-gray-900 ${notification.read ? '' : 'font-medium'}">${notification.message}</p>
                            <p class="text-xs text-gray-500">${formatTimestamp(notification.timestamp)}</p>
                            ${notification.action ? '<p class="text-xs text-purple-600 mt-1">ุงุถุบุท ููุงูุชูุงู</p>' : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function handleNotificationClick(notificationId, action, actionData) {
            // Mark as read
            const notification = notifications.find(n => n.id == notificationId);
            if (notification) {
                notification.read = true;
                saveSystemData();
                updateNotificationBadge();
            }
            
            // Handle action
            if (action) {
                switch (action) {
                    case 'login':
                        if (currentUser?.role === 'admin') {
                            showLoginHistory();
                        }
                        break;
                    case 'year-update':
                        if (currentUser?.role !== 'admin') {
                            showProfile();
                        }
                        break;
                    case 'post':
                        switchTab('posts');
                        break;
                    case 'user-management':
                        if (currentUser?.role === 'admin') {
                            showUserManagement();
                        }
                        break;
                    // Add more actions as needed
                }
            }
            
            document.getElementById('notificationsPopup').classList.add('hidden');
        }

        function getNotificationIcon(type) {
            const icons = {
                'info': '๐ข',
                'login': '๐ค',
                'system': 'โ๏ธ',
                'exam': '๐',
                'post': '๐',
                'user': '๐ฅ'
            };
            return icons[type] || '๐ข';
        }

        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'ุงูุขู';
            if (diff < 3600000) return `ููุฐ ${Math.floor(diff / 60000)} ุฏูููุฉ`;
            if (diff < 86400000) return `ููุฐ ${Math.floor(diff / 3600000)} ุณุงุนุฉ`;
            return `ููุฐ ${Math.floor(diff / 86400000)} ููู`;
        }

        // Enhanced user management with login tracking
        function registerUser(userData) {
            const user = {
                id: Date.now(),
                username: userData.username,
                email: userData.email,
                year: parseInt(userData.year),
                birthdate: userData.birthdate,
                birthdatePrivacy: 'private',
                avatar: null,
                status: 'ูุชุงุญ',
                registrationDate: new Date().toISOString(),
                lastLogin: new Date().toISOString()
            };
            
            users.push(user);
            
            // Add to login history
            loginHistory.unshift({
                id: Date.now(),
                username: userData.username,
                action: 'register',
                timestamp: new Date().toISOString(),
                ip: 'ูุญูู', // Demo IP
                userAgent: navigator.userAgent.substring(0, 50) + '...'
            });
            
            saveUserData();
            updateUserStats();
            
            // Add notification for admin
            addNotification(`ูุณุชุฎุฏู ุฌุฏูุฏ: ${userData.username} ุงูุถู ุฅูู ุงูููุตุฉ`, 'login', 'user-management', null, { username: userData.username });
            
            return user;
        }

        function loginUser(username, password) {
            // Check for admin
            if (username === 'admin' && password === 'admin123') {
                return loginAsAdmin(username);
            }
            
            // Check for existing user or create new one
            let user = users.find(u => u.username === username);
            if (!user) {
                // Create demo user
                user = {
                    id: Date.now(),
                    username: username,
                    email: `${username}@example.com`,
                    year: 1,
                    birthdate: '2000-01-01',
                    birthdatePrivacy: 'private',
                    avatar: null,
                    status: 'ูุชุงุญ',
                    registrationDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                users.push(user);
                
                // Add to login history
                loginHistory.unshift({
                    id: Date.now(),
                    username: username,
                    action: 'first_login',
                    timestamp: new Date().toISOString(),
                    ip: 'ูุญูู',
                    userAgent: navigator.userAgent.substring(0, 50) + '...'
                });
            } else {
                user.lastLogin = new Date().toISOString();
                
                // Add to login history
                loginHistory.unshift({
                    id: Date.now(),
                    username: username,
                    action: 'login',
                    timestamp: new Date().toISOString(),
                    ip: 'ูุญูู',
                    userAgent: navigator.userAgent.substring(0, 50) + '...'
                });
            }
            
            saveUserData();
            updateUserStats();
            
            // Add login notification for admin
            addNotification(`${username} ุณุฌู ุฏุฎูู ุฅูู ุงูููุตุฉ`, 'login', 'login', null, { username: username });
            
            return loginAsUser(user);
        }

        function loginAsUser(user) {
            currentUser = { ...user, role: 'user' };
            
            document.getElementById('loginModal').classList.add('hidden');
            document.getElementById('welcomeUsername').textContent = user.username;
            document.getElementById('welcomePopup').classList.remove('hidden');
            
            updateUserInterface();
            updateNotificationBadge();
            
            return currentUser;
        }

        function loginAsAdmin(username) {
            currentUser = { username: username, role: 'admin' };
            
            // Add to login history
            loginHistory.unshift({
                id: Date.now(),
                username: username,
                action: 'admin_login',
                timestamp: new Date().toISOString(),
                ip: 'ูุญูู',
                userAgent: navigator.userAgent.substring(0, 50) + '...'
            });
            
            saveUserData();
            
            document.getElementById('loginModal').classList.add('hidden');
            updateUserInterface();
            showAdminDashboard();
            updateNotificationBadge();
            
            return currentUser;
        }

        function updateUserInterface() {
            document.getElementById('loginBtn').classList.add('hidden');
            document.getElementById('userMenu').classList.remove('hidden');
            
            if (currentUser.role === 'admin') {
                document.getElementById('userDisplayName').textContent = 'ุงูุฅุฏุงุฑุฉ';
                document.getElementById('userInitial').textContent = 'A';
                document.getElementById('dropdownUsername').textContent = 'ูุฏูุฑ ุงููุธุงู';
                document.getElementById('dropdownYear').textContent = 'ุงูุฅุฏุงุฑุฉ';
                document.getElementById('userStatus').textContent = 'ูุชุตู';
            } else {
                document.getElementById('userDisplayName').textContent = currentUser.username;
                document.getElementById('userInitial').textContent = currentUser.username.charAt(0).toUpperCase();
                document.getElementById('dropdownUsername').textContent = currentUser.username;
                document.getElementById('dropdownYear').textContent = `ุงูุณูุฉ ${getYearName(currentUser.year)}`;
                document.getElementById('userStatus').textContent = currentUser.status || 'ูุชุงุญ';
                
                // Show avatar if available
                if (currentUser.avatar) {
                    document.getElementById('userAvatar').src = currentUser.avatar;
                    document.getElementById('userAvatar').classList.remove('hidden');
                    document.getElementById('userInitial').classList.add('hidden');
                }
                
                // Show sidebar tabs
                document.getElementById('sidebarTabs').classList.remove('hidden');
            }
        }

        function getYearName(year) {
            const yearNames = {
                1: 'ุงูุฃููู',
                2: 'ุงูุซุงููุฉ', 
                3: 'ุงูุซุงูุซุฉ',
                4: 'ุงูุฑุงุจุนุฉ',
                5: 'ุงูุฎุงูุณุฉ'
            };
            return yearNames[year] || 'ุงูุฃููู';
        }

        // Login History Management
        function showLoginHistory() {
            if (currentUser?.role !== 'admin') return;
            
            navigationHistory.push({
                page: currentPage,
                title: getPageTitle(currentPage),
                action: getPageAction(currentPage)
            });
            
            currentPage = 'login-history';
            updateBackButton();
            
            updateBreadcrumb([
                { name: 'ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ', action: 'showAdminDashboard()' },
                { name: 'ุณุฌู ุชุณุฌูู ุงูุฏุฎูู', action: '' }
            ]);
            
            document.getElementById('contentArea').innerHTML = `
                <div class="fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">ุณุฌู ุชุณุฌูู ุงูุฏุฎูู</h2>
                        <div class="flex gap-4">
                            <select id="actionFilter" onchange="filterLoginHistory()" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">ุฌููุน ุงูุฃูุดุทุฉ</option>
                                <option value="login">ุชุณุฌูู ุฏุฎูู</option>
                                <option value="register">ุชุณุฌูู ุฌุฏูุฏ</option>
                                <option value="first_login">ุฃูู ุฏุฎูู</option>
                                <option value="admin_login">ุฏุฎูู ุฅุฏุงุฑุฉ</option>
                            </select>
                            <button onclick="clearLoginHistory()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm">
                                ูุณุญ ุงูุณุฌู
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงููุณุชุฎุฏู</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงููุดุงุท</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงูุชูููุช</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุนููุงู IP</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงููุชุตูุญ</th>
                                    </tr>
                                </thead>
                                <tbody id="loginHistoryTableBody" class="divide-y divide-gray-200">
                                    ${generateLoginHistoryTable()}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Statistics -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mt-8">
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">ุฅุฌูุงูู ุงูุนูููุงุช</p>
                                    <p class="text-2xl font-bold text-gray-900">${loginHistory.length}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐ฅ</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">ูุณุชุฎุฏููู ูุฑูุฏูู</p>
                                    <p class="text-2xl font-bold text-gray-900">${new Set(loginHistory.map(h => h.username)).size}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">ุชุณุฌููุงุช ุฌุฏูุฏุฉ</p>
                                    <p class="text-2xl font-bold text-gray-900">${loginHistory.filter(h => h.action === 'register' || h.action === 'first_login').length}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">โก</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">ูุดุงุท ุงูููู</p>
                                    <p class="text-2xl font-bold text-gray-900">${getTodayLoginCount()}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLoginHistoryTable(filter = null) {
            const filteredHistory = filter ? 
                loginHistory.filter(h => h.action === filter) : loginHistory;
            
            return filteredHistory.map(entry => `
                <tr>
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center ml-3">
                                <span class="text-white text-xs font-medium">${entry.username.charAt(0).toUpperCase()}</span>
                            </div>
                            <span class="text-sm font-medium text-gray-900">${entry.username}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 text-sm">
                        <span class="px-2 py-1 rounded-full text-xs ${getActionColor(entry.action)}">${getActionText(entry.action)}</span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500">${formatFullTimestamp(entry.timestamp)}</td>
                    <td class="px-6 py-4 text-sm text-gray-500">${entry.ip}</td>
                    <td class="px-6 py-4 text-sm text-gray-500" title="${entry.userAgent}">${entry.userAgent}</td>
                </tr>
            `).join('') || '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">ูุง ููุฌุฏ ุณุฌู</td></tr>';
        }

        function getActionColor(action) {
            const colors = {
                'login': 'bg-green-100 text-green-800',
                'register': 'bg-blue-100 text-blue-800',
                'first_login': 'bg-purple-100 text-purple-800',
                'admin_login': 'bg-orange-100 text-orange-800'
            };
            return colors[action] || 'bg-gray-100 text-gray-800';
        }

        function getActionText(action) {
            const texts = {
                'login': 'ุชุณุฌูู ุฏุฎูู',
                'register': 'ุชุณุฌูู ุฌุฏูุฏ',
                'first_login': 'ุฃูู ุฏุฎูู',
                'admin_login': 'ุฏุฎูู ุฅุฏุงุฑุฉ'
            };
            return texts[action] || action;
        }

        function formatFullTimestamp(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleString('ar-SA', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function getTodayLoginCount() {
            const today = new Date();
            const todayStr = today.toDateString();
            return loginHistory.filter(entry => {
                const entryDate = new Date(entry.timestamp);
                return entryDate.toDateString() === todayStr;
            }).length;
        }

        function filterLoginHistory() {
            const selectedAction = document.getElementById('actionFilter').value;
            document.getElementById('loginHistoryTableBody').innerHTML = generateLoginHistoryTable(selectedAction);
        }

        function clearLoginHistory() {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ูุณุญ ุณุฌู ุชุณุฌูู ุงูุฏุฎููุ ูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู.')) {
                loginHistory = [];
                saveUserData();
                showLoginHistory(); // Refresh the view
                alert('ุชู ูุณุญ ุณุฌู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ');
            }
        }

        // Profile management
        function showProfile() {
            if (!currentUser || currentUser.role === 'admin') return;
            
            navigationHistory.push({
                page: currentPage,
                title: getPageTitle(currentPage),
                action: getPageAction(currentPage)
            });
            
            currentPage = 'profile';
            updateBackButton();
            
            updateBreadcrumb([
                { name: 'ุงูุฑุฆูุณูุฉ', action: 'goToHome()' },
                { name: 'ุงูููู ุงูุดุฎุตู', action: '' }
            ]);
            
            document.getElementById('contentArea').innerHTML = `
                <div class="fade-in">
                    <h2 class="text-2xl font-bold text-gray-900 mb-8">ุงูููู ุงูุดุฎุตู</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Profile Info -->
                        <div class="lg:col-span-1">
                            <div class="bg-white rounded-xl shadow-sm p-6">
                                <div class="text-center mb-6">
                                    <div class="relative inline-block">
                                        <div class="w-24 h-24 bg-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 overflow-hidden">
                                            <img id="profileAvatar" src="${currentUser.avatar || ''}" alt="" class="w-full h-full object-cover ${currentUser.avatar ? '' : 'hidden'}">
                                            <span id="profileInitial" class="text-white text-2xl font-medium ${currentUser.avatar ? 'hidden' : ''}">${currentUser.username.charAt(0).toUpperCase()}</span>
                                        </div>
                                        <button onclick="changeAvatar()" class="absolute bottom-0 right-0 bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm hover:bg-purple-700">
                                            ๐ท
                                        </button>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-900">${currentUser.username}</h3>
                                    <p class="text-gray-600">ุงูุณูุฉ ${getYearName(currentUser.year)}</p>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุญุงูุฉ</label>
                                        <select id="userStatusSelect" onchange="updateUserStatus()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                            <option value="ูุชุงุญ" ${currentUser.status === 'ูุชุงุญ' ? 'selected' : ''}>ูุชุงุญ</option>
                                            <option value="ูุดุบูู" ${currentUser.status === 'ูุดุบูู' ? 'selected' : ''}>ูุดุบูู</option>
                                            <option value="ูู ุงูุชุญุงู" ${currentUser.status === 'ูู ุงูุชุญุงู' ? 'selected' : ''}>ูู ุงูุชุญุงู</option>
                                            <option value="ุบูุฑ ูุชุงุญ" ${currentUser.status === 'ุบูุฑ ูุชุงุญ' ? 'selected' : ''}>ุบูุฑ ูุชุงุญ</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Profile Settings -->
                        <div class="lg:col-span-2">
                            <div class="bg-white rounded-xl shadow-sm p-6">
                                <h3 class="text-lg font-bold text-gray-900 mb-6">ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจ</h3>
                                
                                <form id="profileForm" class="space-y-6">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ุงุณู ุงููุณุชุฎุฏู</label>
                                            <input type="text" id="profileUsername" value="${currentUser.username}" 
                                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                                            <input type="email" id="profileEmail" value="${currentUser.email || ''}" 
                                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุณุชูู ุงูุฏุฑุงุณู</label>
                                            <select id="profileYear" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                                <option value="1" ${currentUser.year === 1 ? 'selected' : ''}>ุงูุณูุฉ ุงูุฃููู</option>
                                                <option value="2" ${currentUser.year === 2 ? 'selected' : ''}>ุงูุณูุฉ ุงูุซุงููุฉ</option>
                                                <option value="3" ${currentUser.year === 3 ? 'selected' : ''}>ุงูุณูุฉ ุงูุซุงูุซุฉ</option>
                                                <option value="4" ${currentUser.year === 4 ? 'selected' : ''}>ุงูุณูุฉ ุงูุฑุงุจุนุฉ</option>
                                                <option value="5" ${currentUser.year === 5 ? 'selected' : ''}>ุงูุณูุฉ ุงูุฎุงูุณุฉ</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ุชุงุฑูุฎ ุงููููุงุฏ</label>
                                            <input type="date" id="profileBirthdate" value="${currentUser.birthdate || ''}" 
                                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">ุฎุตูุตูุฉ ุชุงุฑูุฎ ุงููููุงุฏ</label>
                                        <div class="flex gap-4">
                                            <label class="flex items-center">
                                                <input type="radio" name="birthdatePrivacy" value="public" ${currentUser.birthdatePrivacy === 'public' ? 'checked' : ''} class="ml-2">
                                                ุนุงู (ูุธูุฑ ููุฌููุน)
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="birthdatePrivacy" value="private" ${currentUser.birthdatePrivacy === 'private' ? 'checked' : ''} class="ml-2">
                                                ุฎุงุต (ูุง ูุธูุฑ ููุขุฎุฑูู)
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="flex gap-4">
                                        <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                                            ุญูุธ ุงูุชุบููุฑุงุช
                                        </button>
                                        <button type="button" onclick="goToHome()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors">
                                            ุฅูุบุงุก
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Handle form submission
            document.getElementById('profileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                updateProfile();
            });
        }

        function changeAvatar() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const avatarUrl = e.target.result;
                        currentUser.avatar = avatarUrl;
                        
                        // Update user in users array
                        const userIndex = users.findIndex(u => u.id === currentUser.id);
                        if (userIndex !== -1) {
                            users[userIndex].avatar = avatarUrl;
                            saveUserData();
                        }
                        
                        // Update UI
                        document.getElementById('profileAvatar').src = avatarUrl;
                        document.getElementById('profileAvatar').classList.remove('hidden');
                        document.getElementById('profileInitial').classList.add('hidden');
                        
                        document.getElementById('userAvatar').src = avatarUrl;
                        document.getElementById('userAvatar').classList.remove('hidden');
                        document.getElementById('userInitial').classList.add('hidden');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function updateUserStatus() {
            const newStatus = document.getElementById('userStatusSelect').value;
            currentUser.status = newStatus;
            
            // Update user in users array
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].status = newStatus;
                saveUserData();
            }
            
            // Update UI
            document.getElementById('userStatus').textContent = newStatus;
        }

        function updateProfile() {
            const formData = {
                username: document.getElementById('profileUsername').value,
                email: document.getElementById('profileEmail').value,
                year: parseInt(document.getElementById('profileYear').value),
                birthdate: document.getElementById('profileBirthdate').value,
                birthdatePrivacy: document.querySelector('input[name="birthdatePrivacy"]:checked').value
            };
            
            // Update current user
            Object.assign(currentUser, formData);
            
            // Update user in users array
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                Object.assign(users[userIndex], formData);
                saveUserData();
            }
            
            // Update UI
            updateUserInterface();
            alert('ุชู ุญูุธ ุงูุชุบููุฑุงุช ุจูุฌุงุญ!');
        }

        // Posts system
        function showCreatePost() {
            if (!currentUser) return;
            
            navigationHistory.push({
                page: currentPage,
                title: getPageTitle(currentPage),
                action: getPageAction(currentPage)
            });
            
            currentPage = 'create-post';
            updateBackButton();
            
            document.getElementById('contentArea').innerHTML = `
                <div class="fade-in">
                    <div class="flex items-center mb-6">
                        <button onclick="switchTab('posts')" class="text-purple-600 hover:text-purple-700 ml-4">
                            โ ุงูุนูุฏุฉ ุฅูู ุงูููุดูุฑุงุช
                        </button>
                        <h2 class="text-2xl font-bold text-gray-900">ุฅูุดุงุก ููุดูุฑ ุฌุฏูุฏ</h2>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-8">
                        <form id="createPostForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ูุญุชูู ุงูููุดูุฑ</label>
                                <textarea id="postContent" rows="4" required
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                          placeholder="ุงูุชุจ ูุญุชูู ุงูููุดูุฑ ููุง..."></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ุฅุถุงูุฉ ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                    <input type="file" id="postImage" accept="image/*" class="hidden">
                                    <button type="button" onclick="document.getElementById('postImage').click()" 
                                            class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg">
                                        ๐ท ุงุฎุชูุงุฑ ุตูุฑุฉ
                                    </button>
                                    <div id="imagePreview" class="mt-4 hidden">
                                        <img id="previewImg" src="" alt="ูุนุงููุฉ ุงูุตูุฑุฉ" class="max-w-xs mx-auto rounded-lg">
                                    </div>
                                </div>
                            </div>
                            
                            ${currentUser.role === 'admin' ? `
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ุงููุณุชูุฏููู</label>
                                <select id="postTarget" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <option value="">ุฌููุน ุงูุทูุงุจ</option>
                                    <option value="1">ุงูุณูุฉ ุงูุฃููู ููุท</option>
                                    <option value="2">ุงูุณูุฉ ุงูุซุงููุฉ ููุท</option>
                                    <option value="3">ุงูุณูุฉ ุงูุซุงูุซุฉ ููุท</option>
                                    <option value="4">ุงูุณูุฉ ุงูุฑุงุจุนุฉ ููุท</option>
                                    <option value="5">ุงูุณูุฉ ุงูุฎุงูุณุฉ ููุท</option>
                                </select>
                            </div>
                            ` : ''}
                            
                            <div class="flex gap-4">
                                <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                                    ูุดุฑ ุงูููุดูุฑ
                                </button>
                                <button type="button" onclick="switchTab('posts')" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium transition-colors">
                                    ุฅูุบุงุก
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            // Handle image preview
            document.getElementById('postImage').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('previewImg').src = e.target.result;
                        document.getElementById('imagePreview').classList.remove('hidden');
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Handle form submission
            document.getElementById('createPostForm').addEventListener('submit', function(e) {
                e.preventDefault();
                createPost();
            });
        }

        function createPost() {
            const content = document.getElementById('postContent').value.trim();
            const imageFile = document.getElementById('postImage').files[0];
            const targetYear = currentUser.role === 'admin' ? 
                (document.getElementById('postTarget').value || null) : null;
            
            if (!content) return;
            
            const post = {
                id: Date.now(),
                author: currentUser.username,
                authorRole: currentUser.role,
                content: content,
                image: null,
                timestamp: new Date().toISOString(),
                likes: 0,
                comments: [],
                targetYear: targetYear ? parseInt(targetYear) : null
            };
            
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    post.image = e.target.result;
                    posts.unshift(post);
                    saveSystemData();
                    
                    // Add notification
                    addNotification(`ููุดูุฑ ุฌุฏูุฏ ูู ${currentUser.username}`, 'post', 'post');
                    
                    switchTab('posts');
                    alert('ุชู ูุดุฑ ุงูููุดูุฑ ุจูุฌุงุญ!');
                };
                reader.readAsDataURL(imageFile);
            } else {
                posts.unshift(post);
                saveSystemData();
                
                // Add notification
                addNotification(`ููุดูุฑ ุฌุฏูุฏ ูู ${currentUser.username}`, 'post', 'post');
                
                switchTab('posts');
                alert('ุชู ูุดุฑ ุงูููุดูุฑ ุจูุฌุงุญ!');
            }
        }

        function showPosts() {
            const userPosts = posts.filter(post => 
                !post.targetYear || 
                !currentUser || 
                currentUser.role === 'admin' || 
                currentUser.year === post.targetYear
            );
            
            const postsHTML = userPosts.map(post => `
                <div class="bg-white rounded-lg shadow-sm border p-6 mb-4">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center ml-3">
                            <span class="text-white text-sm font-medium">${post.author.charAt(0).toUpperCase()}</span>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-900">${post.author}</h4>
                            <p class="text-xs text-gray-500">${formatTimestamp(post.timestamp)}</p>
                        </div>
                        ${post.targetYear ? `<span class="mr-auto bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs">ุงูุณูุฉ ${getYearName(post.targetYear)}</span>` : ''}
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-gray-700 leading-relaxed">${post.content}</p>
                        ${post.image ? `<img src="${post.image}" alt="ุตูุฑุฉ ุงูููุดูุฑ" class="mt-4 rounded-lg max-w-full h-auto">` : ''}
                    </div>
                    
                    <div class="flex items-center justify-between pt-4 border-t border-gray-200">
                        <div class="flex items-center gap-4">
                            <button onclick="likePost(${post.id})" class="flex items-center gap-2 text-gray-600 hover:text-purple-600">
                                <span>๐</span>
                                <span>${post.likes}</span>
                            </button>
                            <button onclick="showComments(${post.id})" class="flex items-center gap-2 text-gray-600 hover:text-purple-600">
                                <span>๐ฌ</span>
                                <span>${post.comments.length}</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Comments Section -->
                    <div id="comments-${post.id}" class="mt-4 hidden">
                        <div class="space-y-3">
                            ${post.comments.map(comment => `
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <div class="flex items-center mb-2">
                                        <span class="font-medium text-gray-900 text-sm">${comment.author}</span>
                                        <span class="text-xs text-gray-500 mr-2">${formatTimestamp(comment.timestamp)}</span>
                                    </div>
                                    <p class="text-gray-700 text-sm">${comment.content}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        ${currentUser ? `
                        <div class="mt-4 flex gap-2">
                            <input type="text" id="comment-input-${post.id}" placeholder="ุงูุชุจ ุชุนูููุงู..." 
                                   class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm">
                            <button onclick="addComment(${post.id})" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm">
                                ุฅุฑุณุงู
                            </button>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
            
            document.getElementById('postsList').innerHTML = postsHTML || '<p class="text-gray-500 text-center py-8">ูุง ุชูุฌุฏ ููุดูุฑุงุช ุญุงููุงู</p>';
        }

        function likePost(postId) {
            if (!currentUser) return;
            
            const post = posts.find(p => p.id === postId);
            if (post) {
                post.likes++;
                saveSystemData();
                showPosts();
            }
        }

        function showComments(postId) {
            const commentsDiv = document.getElementById(`comments-${postId}`);
            commentsDiv.classList.toggle('hidden');
        }

        function addComment(postId) {
            if (!currentUser) return;
            
            const input = document.getElementById(`comment-input-${postId}`);
            const content = input.value.trim();
            
            if (!content) return;
            
            const post = posts.find(p => p.id === postId);
            if (post) {
                post.comments.push({
                    author: currentUser.username,
                    content: content,
                    timestamp: new Date().toISOString()
                });
                
                saveSystemData();
                input.value = '';
                showPosts();
            }
        }

        // Admin functions
        function showAdminDashboard() {
            navigationHistory.push({
                page: currentPage,
                title: getPageTitle(currentPage),
                action: getPageAction(currentPage)
            });
            
            currentPage = 'admin';
            updateBackButton();
            
            updateBreadcrumb([
                { name: 'ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ', action: '' }
            ]);
            
            document.getElementById('contentArea').innerHTML = `
                <div class="fade-in">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-3xl font-bold text-gray-900">ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ</h2>
                        <div class="flex gap-4">
                            <div class="bg-purple-100 px-4 py-2 rounded-lg">
                                <span class="text-purple-600 font-semibold">๐ฅ ${userStats.total} ุทุงูุจ</span>
                            </div>
                            <div class="bg-blue-100 px-4 py-2 rounded-lg">
                                <span class="text-blue-600 font-semibold">๐ ุงูููู: ${userStats.today}</span>
                            </div>
                            <div class="bg-green-100 px-4 py-2 rounded-lg">
                                <span class="text-green-600 font-semibold">๐ ุงูุฃุณุจูุน: ${userStats.thisWeek}</span>
                            </div>
                            <div class="bg-orange-100 px-4 py-2 rounded-lg">
                                <span class="text-orange-600 font-semibold">๐ ุงูุดูุฑ: ${userStats.thisMonth}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow cursor-pointer" onclick="showUserManagement()">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐ฅ</span>
                                </div>
                                <h3 class="text-lg font-semibold text-gray-900">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h3>
                            </div>
                            <p class="text-gray-600 text-sm">ุนุฑุถ ูุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุงูุทูุงุจ</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow cursor-pointer" onclick="showLoginHistory()">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐</span>
                                </div>
                                <h3 class="text-lg font-semibold text-gray-900">ุณุฌู ุชุณุฌูู ุงูุฏุฎูู</h3>
                            </div>
                            <p class="text-gray-600 text-sm">ุนุฑุถ ุณุฌู ุฏุฎูู ุงููุณุชุฎุฏููู</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow cursor-pointer" onclick="showCreatePost()">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">๐</span>
                                </div>
                                <h3 class="text-lg font-semibold text-gray-900">ุฅูุดุงุก ููุดูุฑ</h3>
                            </div>
                            <p class="text-gray-600 text-sm">ุฅูุดุงุก ููุดูุฑ ุฌุฏูุฏ ููุทูุงุจ</p>
                        </div>
                        
                        <div class="bg-white p-6 rounded-xl shadow-sm border hover:shadow-md transition-shadow cursor-pointer" onclick="showSettings()">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center ml-4">
                                    <span class="text-2xl">โ๏ธ</span>
                                </div>
                                <h3 class="text-lg font-semibold text-gray-900">ุฅุนุฏุงุฏุงุช ุงููุธุงู</h3>
                            </div>
                            <p class="text-gray-600 text-sm">ุฅุนุฏุงุฏุงุช ุงูุชุญูู ุงูุนุงูุฉ</p>
                        </div>
                    </div>
                    
                    <!-- Statistics Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-white rounded-xl shadow-sm p-6">
                            <h3 class="text-lg font-bold text-gray-900 mb-4">ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏููู</h3>
                            <div class="space-y-4">
                                ${generateUserStatsByYear()}
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-sm p-6">
                            <h3 class="text-lg font-bold text-gray-900 mb-4">ุงููุดุงุท ุงูุฃุฎูุฑ</h3>
                            <div class="space-y-3">
                                ${generateRecentActivity()}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateUserStatsByYear() {
            const statsByYear = {};
            for (let i = 1; i <= 5; i++) {
                statsByYear[i] = users.filter(u => u.year === i).length;
            }
            
            return Object.entries(statsByYear).map(([year, count]) => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="font-medium text-gray-700">ุงูุณูุฉ ${getYearName(parseInt(year))}</span>
                    <div class="flex items-center">
                        <div class="w-32 bg-gray-200 rounded-full h-2 ml-3">
                            <div class="bg-purple-600 h-2 rounded-full" style="width: ${Math.max(10, (count / Math.max(userStats.total, 1)) * 100)}%"></div>
                        </div>
                        <span class="text-sm font-semibold text-gray-900">${count}</span>
                    </div>
                </div>
            `).join('');
        }

        function generateRecentActivity() {
            const recentUsers = users
                .filter(u => u.lastLogin)
                .sort((a, b) => new Date(b.lastLogin) - new Date(a.lastLogin))
                .slice(0, 5);
            
            return recentUsers.map(user => `
                <div class="flex items-center justify-between p-3 border-b border-gray-100 last:border-b-0">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center ml-3 overflow-hidden">
                            ${user.avatar ? 
                                `<img src="${user.avatar}" alt="" class="w-full h-full object-cover">` :
                                `<span class="text-white text-xs font-medium">${user.username.charAt(0).toUpperCase()}</span>`
                            }
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-900">${user.username}</p>
                            <p class="text-xs text-gray-500">ุงูุณูุฉ ${getYearName(user.year)}</p>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500">${formatTimestamp(user.lastLogin)}</span>
                </div>
            `).join('') || '<p class="text-gray-500 text-center py-4">ูุง ููุฌุฏ ูุดุงุท ุญุฏูุซ</p>';
        }

        function showUserManagement() {
            navigationHistory.push({
                page: currentPage,
                title: getPageTitle(currentPage),
                action: getPageAction(currentPage)
            });
            
            currentPage = 'users';
            updateBackButton();
            
            updateBreadcrumb([
                { name: 'ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ', action: 'showAdminDashboard()' },
                { name: 'ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู', action: '' }
            ]);
            
            document.getElementById('contentArea').innerHTML = `
                <div class="fade-in">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
                        <div class="flex gap-4">
                            <select id="yearFilter" onchange="filterUsersByYear()" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">ุฌููุน ุงูุณููุงุช</option>
                                <option value="1">ุงูุณูุฉ ุงูุฃููู</option>
                                <option value="2">ุงูุณูุฉ ุงูุซุงููุฉ</option>
                                <option value="3">ุงูุณูุฉ ุงูุซุงูุซุฉ</option>
                                <option value="4">ุงูุณูุฉ ุงูุฑุงุจุนุฉ</option>
                                <option value="5">ุงูุณูุฉ ุงูุฎุงูุณุฉ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงููุณุชุฎุฏู</th>
                                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                                        <th<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'977f09f0b26c32ae',t:'MTc1NjY2OTYzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
